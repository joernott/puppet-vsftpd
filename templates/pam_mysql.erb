# Managed by puppet
#
<% if scope.lookupvar('vsftpd::pam_mysql::ftpusers_file') != '' -%>
auth     required       pam_listfile.so item=user sense=deny file=<%= scope.lookupvar('vsftpd::pam_mysql::ftpusers_file') %> onerr=succeed
<% end -%>
auth required pam_mysql.so <% if scope.lookupvar('vsftpd::pam_mysql::debug') == true -%>debug sqllog=1 verbose=1 <% end -%>user=<%= scope.lookupvar('vsftpd::pam_mysql::sql_user') %> passwd=<%= scope.lookupvar('vsftpd::pam_mysql::sql_password') %> host=<%= scope.lookupvar('vsftpd::pam_mysql::sql_host') %> db=<%= scope.lookupvar('vsftpd::pam_mysql::sql_db') %> table=<%= scope.lookupvar('vsftpd::pam_mysql::sql_table') %> usercolumn=<%= scope.lookupvar('vsftpd::pam_mysql::sql_usercolumn') %> passwdcolumn=<%= scope.lookupvar('vsftpd::pam_mysql::sql_passwdcolumn') %> crypt=<%= scope.lookupvar('vsftpd::pam_mysql::sql_crypt') %> sqllog logtable=<%= scope.lookupvar('vsftpd::pam_mysql::sql_logtable') %> logusercolumn=<%= scope.lookupvar('vsftpd::pam_mysql::sql_logusercolumn') %> logpidcolumn=<%= scope.lookupvar('vsftpd::pam_mysql::sql_logpidcolumn') %> loghostcolumn=<%= scope.lookupvar('vsftpd::pam_mysql::sql_loghostcolumn') %> logtimecolumn=<%= scope.lookupvar('vsftpd::pam_mysql::sql_logtimecolumn') %> logmsgcolumn=<%= scope.lookupvar('vsftpd::pam_mysql::sql_logmsgcolumn') %>
account required pam_mysql.so <% if scope.lookupvar('vsftpd::pam_mysql::debug') == true -%>debug sqllog=1 verbose=1 <% end -%>user=<%= scope.lookupvar('vsftpd::pam_mysql::sql_user') %> passwd=<%= scope.lookupvar('vsftpd::pam_mysql::sql_password') %> host=<%= scope.lookupvar('vsftpd::pam_mysql::sql_host') %> db=<%= scope.lookupvar('vsftpd::pam_mysql::sql_db') %> table=<%= scope.lookupvar('vsftpd::pam_mysql::sql_table') %> usercolumn=<%= scope.lookupvar('vsftpd::pam_mysql::sql_usercolumn') %> passwdcolumn=<%= scope.lookupvar('vsftpd::pam_mysql::sql_passwdcolumn') %> crypt=<%= scope.lookupvar('vsftpd::pam_mysql::sql_crypt') %> sqllog logtable=<%= scope.lookupvar('vsftpd::pam_mysql::sql_logtable') %> logusercolumn=<%= scope.lookupvar('vsftpd::pam_mysql::sql_logusercolumn') %> logpidcolumn=<%= scope.lookupvar('vsftpd::pam_mysql::sql_logpidcolumn') %> loghostcolumn=<%= scope.lookupvar('vsftpd::pam_mysql::sql_loghostcolumn') %> logtimecolumn=<%= scope.lookupvar('vsftpd::pam_mysql::sql_logtimecolumn') %> logmsgcolumn=<%= scope.lookupvar('vsftpd::pam_mysql::sql_logmsgcolumn') %>
session required pam_mysql.so <% if scope.lookupvar('vsftpd::pam_mysql::debug') == true -%>debug sqllog=1 verbose=1 <% end -%>user=<%= scope.lookupvar('vsftpd::pam_mysql::sql_user') %> passwd=<%= scope.lookupvar('vsftpd::pam_mysql::sql_password') %> host=<%= scope.lookupvar('vsftpd::pam_mysql::sql_host') %> db=<%= scope.lookupvar('vsftpd::pam_mysql::sql_db') %> table=<%= scope.lookupvar('vsftpd::pam_mysql::sql_table') %> usercolumn=<%= scope.lookupvar('vsftpd::pam_mysql::sql_usercolumn') %> passwdcolumn=<%= scope.lookupvar('vsftpd::pam_mysql::sql_passwdcolumn') %> crypt=<%= scope.lookupvar('vsftpd::pam_mysql::sql_crypt') %> sqllog logtable=<%= scope.lookupvar('vsftpd::pam_mysql::sql_logtable') %> logusercolumn=<%= scope.lookupvar('vsftpd::pam_mysql::sql_logusercolumn') %> logpidcolumn=<%= scope.lookupvar('vsftpd::pam_mysql::sql_logpidcolumn') %> loghostcolumn=<%= scope.lookupvar('vsftpd::pam_mysql::sql_loghostcolumn') %> logtimecolumn=<%= scope.lookupvar('vsftpd::pam_mysql::sql_logtimecolumn') %> logmsgcolumn=<%= scope.lookupvar('vsftpd::pam_mysql::sql_logmsgcolumn') %>
